(function(e){function t(t){for(var n,o,r=t[0],c=t[1],l=t[2],u=0,m=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,r=1;r<a.length;r++){var c=a[r];0!==s[c]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},s={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"09be":function(e,t,a){"use strict";var n=a("c5f2"),s=a.n(n);s.a},"146f":function(e,t,a){"use strict";var n=a("5abb"),s=a.n(n);s.a},"452c":function(e,t,a){},"4b17":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("header",[e.isAuthenticated?[a("div",[a("router-link",{staticClass:"header-item",attrs:{to:"/"}},[e._v("掲示板")]),a("span",{staticClass:"header-item",on:{click:e.logout}},[e._v("ログアウト")])],1)]:e._e(),e.isAuthenticated?e._e():[a("div",[a("router-link",{staticClass:"header-item",attrs:{to:"/login"}},[e._v("ログイン")]),a("router-link",{staticClass:"header-item",attrs:{to:"/register"}},[e._v("登録")])],1)]],2),a("router-view")],1)},i=[],o={computed:{isAuthenticated:function(){return null!==this.$store.getters.idToken}},methods:{logout:function(){this.$store.dispatch("logout")}}},r=o,c=(a("8bdf"),a("b0a0"),a("2877")),l=Object(c["a"])(r,s,i,!1,null,"51a117c1",null),d=l.exports,u=a("bc3a"),m=a.n(u),p=a("8c4f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"postarea"},[a("h2",{staticClass:"align-items-center"},[e._v("掲示板に投稿する")]),a("div",{staticClass:"mt-4 pt-4 mb-4 pb-4"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-5"},[e._v("ニックネーム")]),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",id:"name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})])]),a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-5"},[e._v("コメント")]),a("div",{staticClass:"col-md-7"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],attrs:{id:"comment"},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}})])]),a("div",{staticClass:"col-md-12 mt-4"},[a("button",{staticClass:"btn btn-primary pl-4 pr-4",on:{click:e.createComment}},[e._v(" 掲示板に送信 ")])]),a("hr")]),a("h2",{staticClass:"bbs mb-4"},[e._v("掲示板")]),e._l(e.posts,(function(t){return a("div",{key:t.name,staticClass:"mt-2 mb-2"},[a("div",[e._v("名前："+e._s(t.fields.name.stringValue))]),a("div",{staticClass:"mt-4"},[e._v("コメント："+e._s(t.fields.comment.stringValue))]),a("hr")])}))],2)},v=[],h=(a("b0c0"),{data:function(){return{name:"",comment:"",posts:[]}},computed:{idToken:function(){return this.$store.getters.idToken}},created:function(){var e=this;m.a.get("/comments",{headers:{Authorization:"Bearer ".concat(this.idToken)}}).then((function(t){e.posts=t.data.documents}))},methods:{createComment:function(){m.a.post("/comments",{fields:{name:{stringValue:this.name},comment:{stringValue:this.comment}}},{headers:{Authorization:"Bearer ".concat(this.idToken)}}),this.name="",this.comment=""}}}),g=h,b=(a("09be"),Object(c["a"])(g,f,v,!1,null,"109e5749",null)),k=b.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("h2",{staticClass:"align-items-center"},[e._v("ログイン")]),a("div",{staticClass:"container mt-4 pt-4 mb-4 pb-4"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-4"},[e._v("Email")]),a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",id:"email",placeholder:"emailアドレス"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})])]),a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-4"},[e._v("パスワード")]),a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",placeholder:"半角英数6文字以上"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})])]),a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-12 mt-4"},[a("button",{staticClass:"btn btn-primary",on:{click:e.login}},[e._v("ログイン")])])])])])},T=[],_={data:function(){return{email:"",password:""}},methods:{login:function(){this.$store.dispatch("login",{email:this.email,password:this.password}),this.email="",this.password=""}}},C=_,y=(a("cbce"),Object(c["a"])(C,w,T,!1,null,"636787b6",null)),x=y.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"register"},[a("h2",[e._v("登録")]),a("div",{staticClass:"container mt-4 pt-4 mb-4 pb-4"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-4"},[e._v("Email")]),a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",id:"email",placeholder:"emailアドレス"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}})])]),a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-4"},[e._v("パスワード")]),a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",placeholder:"半角英数6文字以上"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})])]),a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-md-12 mt-4"},[a("button",{staticClass:"btn btn-primary",on:{click:e.register}},[e._v("登録")])])])])])},S=[],j={data:function(){return{email:"",password:""}},methods:{register:function(){this.$store.dispatch("register",{email:this.email,password:this.password}),this.email="",this.password=""}}},O=j,P=(a("146f"),Object(c["a"])(O,I,S,!1,null,"5b0c12c2",null)),A=P.exports,U=(a("ac1f"),a("5319"),a("96cf"),a("1da1")),$=a("2f62"),E=m.a.create({baseURL:"https://identitytoolkit.googleapis.com/v1"}),z=E,R=m.a.create({baseURL:"https://securetoken.googleapis.com/v1"}),D=R;n["default"].use($["a"]);var M=new $["a"].Store({state:{idToken:null},getters:{idToken:function(e){return e.idToken}},mutations:{updateIdToken:function(e,t){e.idToken=t}},actions:{autoLogin:function(e){return Object(U["a"])(regeneratorRuntime.mark((function t(){var a,n,s,i,o,r,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.commit,n=e.dispatch,s=localStorage.getItem("idToken"),s){t.next=4;break}return t.abrupt("return");case 4:if(i=new Date,o=localStorage.getItem("idToken"),r=i.getTime()>=o,c=localStorage.getItem("refreshToken"),!r){t.next=13;break}return t.next=11,n("refreshIdToken",c);case 11:t.next=16;break;case 13:l=o-i.getTime(),setTimeout((function(){n("refreshIdToken",c)}),l),a("updateIdToken",s);case 16:case"end":return t.stop()}}),t)})))()},login:function(e,t){var a=e.dispatch;z.post("/accounts:signInWithPassword?key=AIzaSyBT4Uyj3FiozU6T7pgcwCo2-Z_8PqQaxkc",{email:t.email,password:t.password,returnSecureToken:!0}).then((function(e){a("setAuthData",{idToken:e.data.idToken,expiresIn:e.data.expiresIn,refreshToken:e.data.refreshToken}),L.push("/")}))},logout:function(e){var t=e.commit;t("updateIdToken",null),localStorage.removeItem("idToken"),localStorage.removeItem("expiryTimeMs"),localStorage.removeItem("refreshToken"),L.replace("/login")},refreshIdToken:function(e,t){return Object(U["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.dispatch,a.next=3,D.post("/token?key=AIzaSyBT4Uyj3FiozU6T7pgcwCo2-Z_8PqQaxkc",{grant_type:"refresh_token",refresh_token:t}).then((function(e){n("setAuthData",{idToken:e.data.id_token,expiresIn:e.data.expire_in,refreshToken:e.data.refresh_token})}));case 3:case"end":return a.stop()}}),a)})))()},register:function(e,t){var a=e.dispatch;z.post("/accounts:signUp?key=AIzaSyBT4Uyj3FiozU6T7pgcwCo2-Z_8PqQaxkc",{email:t.email,password:t.password,returnSecureToken:!0}).then((function(e){a("setAuthData",{idToken:e.data.idToken,expiresIn:e.data.expiresIn,refreshToken:e.data.refreshToken}),L.push("/")}))},setAuthData:function(e,t){var a=e.commit,n=e.dispatch,s=new Date,i=s.getTime()+1e3*t.expiresIn;a("updateIdToken",t.idToken),localStorage.setItem("idToken",t.idToken),localStorage.setItem("expiryTimeMs",i),localStorage.setItem("refreshToken",t.refreshToken),setTimeout((function(){n("refreshIdToken",t.idToken)}),1e3*t.expiresIn)}}}),N=a("5f5b"),B=a("b1e0");a("f9e3"),a("2dd8");n["default"].use(N["a"]),n["default"].use(B["a"]),n["default"].use(p["a"]);var L=new p["a"]({mode:"history",routes:[{path:"/",component:k,beforeEnter:function(e,t,a){M.getters.idToken?a():a("/login")}},{path:"/login",component:x,beforeEnter:function(e,t,a){M.getters.idToken?a("/"):a()}},{path:"/register",component:A,beforeEnter:function(e,t,a){M.getters.idToken?a("/"):a()}}]});n["default"].config.productionTip=!1,m.a.defaults.baseURL="https://firestore.googleapis.com/v1/projects/memoriya-v/databases/(default)/documents",M.dispatch("autoLogin"),new n["default"]({router:L,store:M,render:function(e){return e(d)}}).$mount("#app")},"5abb":function(e,t,a){},"8bdf":function(e,t,a){"use strict";var n=a("4b17"),s=a.n(n);s.a},b0a0:function(e,t,a){"use strict";var n=a("452c"),s=a.n(n);s.a},c5f2:function(e,t,a){},cbce:function(e,t,a){"use strict";var n=a("efbc"),s=a.n(n);s.a},efbc:function(e,t,a){}});
//# sourceMappingURL=app.b2c5527b.js.map